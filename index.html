<script>
    function calculatePNG(isFormative) {
        let nama = document.getElementById("nama").value;
        let melayu = parseFloat(document.getElementById("melayu").value);
        let inggeris = parseFloat(document.getElementById("inggeris").value);
        let math = parseFloat(document.getElementById("math").value);
        let sci = parseFloat(document.getElementById("sci").value);
        let reka = parseFloat(document.getElementById("reka").value);
        let islam = parseFloat(document.getElementById("islam").value);
        let sj = parseFloat(document.getElementById("sj").value);
        let geog = parseFloat(document.getElementById("geog").value);
        let ask = isFormative ? 0 : parseFloat(document.getElementById("ask").value);
        let psv = isFormative ? 0 : parseFloat(document.getElementById("psv").value);

        // Helper function to calculate grade
        function getGPA(score) {
            if (score >= 80) return 4.00;
            if (score >= 75) return 3.75;
            if (score >= 70) return 3.50;
            if (score >= 65) return 3.25;
            if (score >= 60) return 3.00;
            if (score >= 55) return 2.75;
            if (score >= 50) return 2.50;
            if (score >= 45) return 2.25;
            if (score >= 40) return 2.00;
            if (score >= 35) return 1.00;
            return 0.00;
        }

        // Calculate GPA for each subject
        let bm = getGPA(melayu) * 5.00;
        let bi = getGPA(inggeris) * 5.00;
        let mt = getGPA(math) * 5.00;
        let sn = getGPA(sci) * 5.00;
        let rbt = getGPA(reka) * 4.00;
        let pai = getGPA(islam) * 4.00;
        let sej = getGPA(sj) * 3.00;
        let geo = getGPA(geog) * 3.00;

        let totalSubjects = 34;
        let additionalMarks = 0; // Initialize as 0 to ensure it doesn't cause issues

        if (!isFormative) {
            let Ask = getGPA(ask) * 2.00;
            let Seni = getGPA(psv) * 2.00;
            totalSubjects = 38;
            additionalMarks = Ask + Seni;
        }

        let total = bm + bi + mt + sn + rbt + pai + sej + geo + additionalMarks;
        let purata = total / totalSubjects;

        // Display result
        document.getElementById("result").innerHTML = "PNG anda ialah: " + purata.toFixed(2);

        // Motivational message
        let message = "";
        if (purata === 4.00) {
            message = "Tahniah " + nama + "!, Anda mendapat pointer 4.00. Kekalkan prestasi anda.";
        } else if (purata >= 3.50) {
            message = "Tahniah " + nama + "!, Teruskan usaha anda.";
        } else if (purata >= 3.00) {
            message = "Anda sudah lakukan yang terbaik, " + nama + "! Cuba Lagi dalam ujian seterusnya.";
        } else {
            message = "Jangan putus asa, " + nama + ". Teruskan berusaha dengan lebih gigih.";
        }
        document.getElementById("message").innerHTML = message;
    }

    function toggleExtraFields(show) {
        document.getElementById('extra-fields').style.display = show ? 'block' : 'none';
    }
</script>

